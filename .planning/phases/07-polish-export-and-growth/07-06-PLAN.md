---
phase: 07-polish-export-and-growth
plan: 06
type: execute
wave: 2
depends_on: ["07-04"]
files_modified:
  - src/components/comparison/OptionCard.tsx
  - src/components/comparison/HeroSummary.tsx
  - src/components/comparison/LineItemsBreakdown.tsx
  - src/components/comparison/MarketValueBanner.tsx
  - src/components/forms/LeaseForm.tsx
  - src/app/layout.tsx
  - src/app/globals.css
autonomous: false

must_haves:
  truths:
    - "Keyboard Tab key reaches every interactive element (buttons, collapsibles, links, form fields)"
    - "Screen reader announces scenario names, costs, and line item breakdowns meaningfully"
    - "Focus indicator is visible on all interactive elements"
    - "No automated WCAG 2.1 AA violations detected by axe-core audit"
  artifacts:
    - path: "src/components/comparison/OptionCard.tsx"
      provides: "ARIA labels on collapsible trigger, heading hierarchy"
      contains: "aria-"
    - path: "src/components/comparison/HeroSummary.tsx"
      provides: "Screen reader-friendly cost summary with sr-only labels"
      contains: "sr-only"
    - path: "src/app/globals.css"
      provides: "focus-visible styles for keyboard navigation"
      contains: "focus-visible"
  key_links:
    - from: "src/components/comparison/OptionCard.tsx"
      to: "aria-expanded"
      via: "collapsible state communicated to screen readers"
      pattern: "aria-expanded"
    - from: "src/app/layout.tsx"
      to: "skip navigation"
      via: "skip-to-content link for keyboard users"
      pattern: "skip"
---

<objective>
Audit and fix accessibility to meet WCAG 2.1 AA compliance across the application, focusing on keyboard navigation, screen reader support, and ARIA labels.

Purpose: PLSH-04 requires keyboard navigation, screen reader support, and no WCAG AA violations. This is the final polish before the app is production-ready.

Output: Accessible comparison view with proper ARIA attributes, skip navigation, focus management, and a manual verification checkpoint.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-polish-export-and-growth/07-RESEARCH.md
@src/components/comparison/OptionCard.tsx
@src/components/comparison/HeroSummary.tsx
@src/components/comparison/LineItemsBreakdown.tsx
@src/components/comparison/ComparisonView.tsx
@src/components/forms/LeaseForm.tsx
@src/app/layout.tsx
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add skip navigation, focus styles, and ARIA attributes</name>
  <files>
    src/app/layout.tsx
    src/app/globals.css
    src/components/comparison/OptionCard.tsx
    src/components/comparison/HeroSummary.tsx
    src/components/comparison/LineItemsBreakdown.tsx
    src/components/comparison/ComparisonView.tsx
  </files>
  <action>
    layout.tsx:
    1. Add skip-to-content link as first child of body:
       ```tsx
       <a href="#main-content" className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-primary focus:text-primary-foreground focus:px-4 focus:py-2 focus:rounded">
         Skip to main content
       </a>
       ```
    2. Ensure body has proper landmark structure (it does via semantic HTML)

    globals.css:
    1. Add global focus-visible styles to ensure visible keyboard focus on all interactive elements:
       ```css
       *:focus-visible {
         outline: 2px solid hsl(var(--primary));
         outline-offset: 2px;
       }
       ```
       This ensures every focusable element shows a visible teal ring when keyboard-focused, without affecting mouse clicks (focus-visible vs focus).

    ComparisonView.tsx:
    1. Add id="main-content" to the main container div (or wrap in main with id)
    2. Add section landmarks: wrap HeroSummary in `<section aria-label="Recommendation summary">`
    3. Wrap OptionsList in `<section aria-label="Exit options comparison">`
    4. Wrap disclaimers in `<section aria-label="Disclaimers">`

    HeroSummary.tsx:
    1. Add sr-only context to cost values. Each option cost in the grid should have:
       `<span className="sr-only">{formatOptionName(opt.type)}:</span>` before the cost
       OR use aria-label on the container div: `aria-label={`${formatOptionName(opt.type)}: ${formatCurrency(opt.netCost)}`}`
    2. Ensure the "Best Move" heading is an h2 (currently it's a CardTitle -- verify the rendered HTML is a heading)
    3. Tie message should use role="status" for live region announcements

    OptionCard.tsx:
    1. Add aria-label to the Collapsible trigger: `aria-label={`View cost breakdown for ${formatOptionName(scenario.type)}`}`
    2. The Collapsible from Radix already handles aria-expanded -- verify this is true
    3. Add role="region" and aria-label to the CollapsibleContent wrapper
    4. Warnings box: add role="alert" so screen readers announce warnings
    5. Ensure rank badge has aria-label: `aria-label={`Ranked number ${rank}`}` (or hide decorative # with aria-hidden)

    LineItemsBreakdown.tsx:
    1. If line items render as a list, ensure proper semantic structure (dl/dt/dd or table with scope)
    2. Add sr-only text for credit items: amounts that are negative/credits should announce "credit" not just the number
    3. Ensure the "You receive:" prefix is visible (already done in Phase 3) -- just verify
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `npm run build` succeeds
    - Tab through the comparison page in browser: every button, link, collapsible is reachable
    - Skip link appears on focus (press Tab once on page load)
    - Focus ring visible on all focused elements
  </verify>
  <done>
    Skip-to-content link works. Global focus-visible styles show teal ring on keyboard navigation. All comparison components have proper ARIA labels, landmarks, and screen reader context. Tab order reaches all interactive elements.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Accessibility improvements across the application:
    - Skip-to-content navigation link (visible on keyboard focus)
    - Global focus-visible ring styles
    - ARIA labels on comparison option cards, collapsibles, and hero summary
    - Section landmarks for screen reader navigation
    - sr-only context for cost values
  </what-built>
  <how-to-verify>
    1. Open http://localhost:3000/lease (or navigate to a lease comparison page)
    2. Press Tab once -- "Skip to main content" link should appear in top-left
    3. Press Tab through the comparison page -- verify every button and link shows a visible teal focus ring
    4. Press Tab to reach "View cost breakdown" on an option card -- press Enter/Space to expand
    5. Continue tabbing through expanded content
    6. Optional: Enable VoiceOver (Cmd+F5 on macOS) and navigate through comparison -- verify scenario names and costs are announced
    7. Check that no text is cut off or overlapping after accessibility changes
    8. Run Lighthouse accessibility audit in Chrome DevTools -> should score 90+ on accessibility
  </how-to-verify>
  <resume-signal>Type "approved" or describe any accessibility issues found</resume-signal>
</task>

</tasks>

<verification>
- Skip link visible on first Tab press
- Focus ring on all interactive elements during keyboard navigation
- Screen reader announces option names and costs in meaningful order
- Lighthouse accessibility score >= 90
- No visual regressions on comparison or timeline pages
</verification>

<success_criteria>
- Every interactive element reachable via keyboard Tab
- Visible focus indicator on all focused elements
- Screen reader announces comparison data meaningfully
- Lighthouse accessibility >= 90 (automated WCAG checks)
- Human verified via checkpoint
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-export-and-growth/07-06-SUMMARY.md`
</output>
