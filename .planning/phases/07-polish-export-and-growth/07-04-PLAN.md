---
phase: 07-polish-export-and-growth
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/comparison/ComparisonView.tsx
  - src/components/comparison/HeroSummary.tsx
  - src/components/comparison/OptionCard.tsx
  - src/components/comparison/OptionsList.tsx
  - src/components/timeline/TimelineChart.tsx
  - src/app/lease/[id]/compare/page.tsx
  - src/app/lease/[id]/timeline/page.tsx
autonomous: true

must_haves:
  truths:
    - "Comparison view is usable on a phone screen without horizontal scrolling"
    - "HeroSummary option costs wrap properly on narrow screens"
    - "OptionCards stack vertically with full-width on mobile"
    - "Timeline chart is readable on mobile with touch-friendly tooltip"
  artifacts:
    - path: "src/components/comparison/HeroSummary.tsx"
      provides: "Responsive grid that wraps gracefully on mobile"
      contains: "grid"
    - path: "src/components/comparison/OptionCard.tsx"
      provides: "Full-width card layout on all screen sizes"
    - path: "src/components/timeline/TimelineChart.tsx"
      provides: "Chart with responsive sizing and mobile-friendly tooltip"
  key_links:
    - from: "src/components/comparison/ComparisonView.tsx"
      to: "src/components/comparison/HeroSummary.tsx"
      via: "renders HeroSummary with responsive container"
      pattern: "HeroSummary"
---

<objective>
Optimize the comparison view and timeline for mobile phone screens so all critical data is accessible without horizontal scrolling.

Purpose: PLSH-02 requires the comparison view to be usable on a phone. Currently the layout works on desktop but may have cramped elements on narrow screens. This plan ensures the option costs, cards, and chart adapt to mobile widths.

Output: Mobile-optimized comparison and timeline pages with proper stacking, wrapping, and touch interactions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-polish-export-and-growth/07-RESEARCH.md
@src/components/comparison/ComparisonView.tsx
@src/components/comparison/HeroSummary.tsx
@src/components/comparison/OptionCard.tsx
@src/components/comparison/OptionsList.tsx
@src/components/timeline/TimelineChart.tsx
@src/app/lease/[id]/compare/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Optimize comparison view components for mobile</name>
  <files>
    src/components/comparison/HeroSummary.tsx
    src/components/comparison/OptionCard.tsx
    src/components/comparison/ComparisonView.tsx
    src/app/lease/[id]/compare/page.tsx
  </files>
  <action>
    Review each component and apply mobile-first responsive patterns:

    HeroSummary.tsx:
    - The quick-glance cost grid currently uses `grid-cols-2 sm:grid-cols-3 md:flex md:justify-between`. With 6 options (after lease transfer), this needs to handle wrapping gracefully
    - Change to: `grid grid-cols-2 gap-3 sm:grid-cols-3 lg:grid-cols-6` so costs wrap in 2-col on mobile, 3-col on tablet, all-in-row on desktop
    - Ensure text truncation doesn't hide option names -- use `text-xs` on mobile for option names
    - Total cost numbers: use `text-sm` base with `md:text-base` for larger screens

    OptionCard.tsx:
    - Already card-based (good for mobile). Verify:
    - Card header flex layout: rank badge + name on left, cost on right. On very small screens (< 360px), the cost might wrap. Add `shrink-0` to the cost span to prevent wrapping
    - Collapsible trigger button: ensure touch target is at least 44x44px (WCAG 2.5.5). Add `min-h-[44px]` if needed
    - Warning box padding: reduce to `p-2` on mobile for better space usage

    ComparisonView.tsx:
    - Container is `max-w-4xl mx-auto px-4 py-8`. Reduce vertical padding on mobile: `py-4 md:py-8`
    - Market value section spacing: `mb-4 md:mb-6`

    compare/page.tsx:
    - Back nav and heading: reduce heading size on mobile. Already has `text-2xl md:text-3xl` -- good
    - Timeline CTA card at bottom: ensure padding doesn't waste space on mobile. Use `p-4 md:p-6`
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Dev server renders comparison page at mobile widths (use browser devtools at 375px, 390px, 414px widths) without horizontal scrollbar
    - All 5 current options visible without scrolling on hero summary
  </verify>
  <done>
    Comparison view renders cleanly at 375px width. No horizontal scrolling. Option costs wrap in 2-column grid on mobile. Touch targets meet 44px minimum. Cards stack vertically.
  </done>
</task>

<task type="auto">
  <name>Task 2: Optimize timeline page for mobile</name>
  <files>
    src/components/timeline/TimelineChart.tsx
    src/app/lease/[id]/timeline/page.tsx
  </files>
  <action>
    TimelineChart.tsx:
    - Recharts ChartContainer should already handle responsive width via shadcn/ui. Verify the chart doesn't have a fixed minWidth that forces horizontal scroll
    - If chart has hardcoded width, switch to `width="100%"` with ChartContainer aspect ratio
    - On mobile, the legend (scenario names) may overlap. Move legend below chart on small screens:
      - Use Recharts `<Legend />` with `wrapperStyle` that responds to container width
      - Or use a custom legend component below the chart that shows colored dots + names in a wrapping flex layout
    - Y-axis labels: already use abbreviated format ($12K). Ensure they don't clip on narrow screens. Consider hiding Y-axis labels on very small screens and relying on tooltip
    - Tooltip: ensure it's usable on touch (Recharts supports touch by default). Make tooltip width responsive: `max-w-[280px]` on mobile
    - X-axis: if month labels are crowded, use tickFormatter to show every 3rd month on mobile, every month on desktop. Or use `interval="preserveStartEnd"` for auto-spacing

    timeline/page.tsx:
    - Reduce padding on mobile: `py-4 md:py-8` for the container
    - Recommendation summary card: ensure it wraps text properly on narrow screens
    - Inflection markers: check that the text doesn't overflow on mobile
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Dev server renders timeline page at 375px width without horizontal scroll
    - Chart is visible and interactive (hover/touch shows tooltip) on mobile widths
  </verify>
  <done>
    Timeline chart renders responsively at mobile widths. Legend doesn't overlap chart. Tooltip is readable. X-axis labels don't crowd. No horizontal scrolling.
  </done>
</task>

</tasks>

<verification>
- Open comparison page at 375px, 390px, 768px, 1024px widths -- no horizontal scroll at any breakpoint
- Open timeline page at same widths -- chart is visible and interactive
- Existing desktop layout preserved at >= 1024px
- `npm run build` succeeds
</verification>

<success_criteria>
- No horizontal scrolling on any page at 375px width
- Option costs in HeroSummary wrap properly in 2-col grid on mobile
- Timeline chart is visible and touch-interactive on mobile
- Desktop layout unchanged at >= 1024px
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-export-and-growth/07-04-SUMMARY.md`
</output>
