---
phase: 02-lease-entry-and-core-ui
plan: 04
type: execute
wave: 4
depends_on: ["02-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can enter 5 essential lease fields and save to database"
    - "Saved lease appears in the lease list and persists across refresh"
    - "User can edit a saved lease with pre-filled data"
    - "User can delete a lease with confirmation"
    - "Educational tooltips appear on (?) icon click with friendly explanations"
    - "Progressive disclosure expands to show optional fields"
    - "Validation errors show after first submit attempt with helpful messages"
    - "Form auto-saves draft to localStorage during entry"
  artifacts: []
  key_links: []
---

<objective>
Visually verify the complete lease entry flow: create, edit, delete, tooltips, validation, progressive disclosure, and persistence across sessions.

Purpose: Human eyes confirm the warm design, educational tooltips, validation UX, and complete CRUD flow work as intended before marking Phase 2 complete.
Output: Verified or issues identified for gap closure.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-lease-entry-and-core-ui/02-CONTEXT.md
@.planning/phases/02-lease-entry-and-core-ui/02-01-SUMMARY.md
@.planning/phases/02-lease-entry-and-core-ui/02-02-SUMMARY.md
@.planning/phases/02-lease-entry-and-core-ui/02-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start dev server and verify build</name>
  <files></files>
  <action>
    1. Run `npm run build` to verify the full application compiles without errors.
    2. Run `npm run dev` to start the development server.
    3. Verify the server starts successfully and report the URL (typically http://localhost:3000).

    NOTE: If DATABASE_URL is not set, the build may fail on server action imports. If this happens:
    - Check if `.env` or `.env.local` exists with DATABASE_URL
    - If not, the server actions that import db/client will fail at build time
    - Report this as a blocker -- the user needs to set up their Neon database connection
    - The form UI components should still render even without DB connection (client components don't import db)
  </action>
  <verify>
    - `npm run build` succeeds OR reports clear DATABASE_URL error
    - Dev server starts and is accessible
  </verify>
  <done>
    Development server running. Build status confirmed (success or known DATABASE_URL blocker documented).
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete lease entry flow with:
    - Warm, approachable visual design (rounded corners, soft colors)
    - 5 essential fields with educational (?) tooltips on each
    - Progressive disclosure "Add more details" section with optional fields
    - Form validation with friendly error messages (after first submit attempt)
    - Auto-save drafts to localStorage
    - Server-side persistence to Postgres via Drizzle ORM
    - Lease list page with edit and delete actions
    - Delete confirmation before removing a lease
    - Current mileage date-stamping
    - Home page with navigation to lease entry
  </what-built>
  <how-to-verify>
    Open http://localhost:3000 in your browser and test:

    **1. Home Page**
    - Verify warm, approachable styling (not harsh/corporate)
    - Click "Enter Your Lease" button -- should navigate to /lease/new

    **2. New Lease Form (/lease/new)**
    - Verify 5 essential fields visible: Monthly Payment, Lease Term, Mileage Allowance, Residual Value, Current Mileage
    - Click (?) icon on "Residual Value" -- popover should show friendly explanation, "where to find", and "learn more" link
    - Click (?) on "Money Factor" (in optional section) -- should explain what it is and how to find it
    - Click "Add more details" -- should expand to show optional fields in grouped sections
    - Note the completeness indicator ("X of Y added") on the expand button

    **3. Validation**
    - Leave all fields empty and click "Save Lease" -- should show friendly error messages on required fields
    - Enter a very large monthly payment (e.g., 9999) -- should show amber/yellow warning but allow submission
    - Verify error tone is friendly, not scolding

    **4. Save and Persistence**
    - Fill in: Monthly Payment = 450, Term = 36, Mileage = 12000, Residual = 18000, Current Mileage = 15000
    - Click "Save Lease" -- should save and redirect to /lease
    - Verify the lease appears in the list
    - Refresh the page -- lease should still be there

    **5. Edit**
    - Click "Edit" on the saved lease
    - Verify all fields are pre-filled with the saved values
    - Change monthly payment to 475
    - Click "Save Changes" -- should update without creating a duplicate
    - Go back to list -- verify updated payment shows

    **6. Delete**
    - Click "Delete" on the lease
    - Verify confirmation step appears (not instant delete)
    - Confirm delete -- lease should disappear from list

    **7. Auto-Save Draft**
    - Start entering a new lease (/lease/new)
    - Fill in a couple fields
    - Close the browser tab
    - Reopen /lease/new -- draft should be restored

    **8. Responsive**
    - Resize browser to mobile width
    - Verify form is usable (full width, no horizontal scroll, fields stack properly)

    NOTE: If DATABASE_URL is not configured, steps 4-6 will fail. You can still verify steps 1-3, 7-8 (client-side only). Report whether DB is connected.
  </how-to-verify>
  <resume-signal>Type "approved" if the flow works correctly, or describe any issues you see (visual, functional, or UX problems).</resume-signal>
</task>

</tasks>

<verification>
All Phase 2 success criteria verified by human:
1. User can enter a lease starting with 5 essential fields and optionally expand
2. Hovering/tapping (?) shows plain-English explanation
3. Invalid input caught with clear error messages
4. Saved lease persists across browser sessions and can be edited/deleted
5. Current mileage entries are date-stamped
</verification>

<success_criteria>
Human approves the complete lease entry flow covering create, read, update, delete, tooltips, validation, progressive disclosure, auto-save, and visual design quality.
</success_criteria>

<output>
After completion, create `.planning/phases/02-lease-entry-and-core-ui/02-04-SUMMARY.md`
</output>
